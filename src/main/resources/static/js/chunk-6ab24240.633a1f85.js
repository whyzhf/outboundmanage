(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ab24240","chunk-5a269d12"],{"0a72":function(t,e,n){"use strict";var i=n("5e9d"),r=n.n(i);r.a},"33de":function(t,e,n){"use strict";function i(){return new Promise(function(t,e){if(window.AMap)t(window.AMap);else{var n=document.createElement("script"),i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href","https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"),n.type="text/javascript",n.async=!1,n.src="https://webapi.amap.com/maps?v=1.4.15&callback=initAMap&key=0f31751255b231fcd092f6431b136a83&plugin=AMap.GraspRoad",n.onerror=e,document.head.appendChild(i),document.head.appendChild(n)}window.initAMap=function(){t(window.AMap)}})}n.d(e,"a",function(){return i})},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"386d":function(t,e,n){"use strict";var i=n("cb7c"),r=n("83a1"),o=n("5f1b");n("214f")("search",1,function(t,e,n,a){return[function(n){var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=i(t),c=String(this),l=s.lastIndex;r(l,0)||(s.lastIndex=0);var p=o(s,c);return r(s.lastIndex,l)||(s.lastIndex=l),null===p?-1:p.index}]})},"5db4":function(t,e,n){},"5e9d":function(t,e,n){},"6b54":function(t,e,n){"use strict";n("3846");var i=n("cb7c"),r=n("0bfb"),o=n("9e1e"),a="toString",s=/./[a],c=function(t){n("2aba")(RegExp.prototype,a,t,!0)};n("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?c(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)}):s.name!=a&&c(function(){return s.call(this)})},7874:function(t,e,n){"use strict";var i=n("5db4"),r=n.n(i);r.a},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},a29b:function(t,e,n){},aacb:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"current-map"}})},r=[],o=(n("8e6e"),n("456d"),n("ac6a"),n("6b54"),n("386d"),n("bd86")),a=n("33de"),s=(n("c385"),n("2f62"));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var p={name:"CurrentMap",data:function(){return{theamap:null,createMap:null,polygon:[],origin:"",destination:"",taskId:0,prisonerList:{},markerList:[],infoWindow:{}}},mounted:function(){Array.isArray(this.multipleSelection)?this.$message.error("请先在任务列表中选择要查看的任务"):(this.multipleSelection.rail&&(this.polygon=this.multipleSelection.rail.reduce(function(t,e){var n=[e.lng,e.lat];return t.push(n),t},[])),this.taskId=this.multipleSelection.id,this.origin=this.multipleSelection.origin,this.destination=this.multipleSelection.destination,this.initMap(),this.livePosition())},computed:l({},Object(s["d"])({multipleSelection:function(t){return t.multipleSelection}})),methods:{initMap:function(){var t=this,e=this;Object(a["a"])().then(function(n){console.log("地图加载成功"),e.theamap=n,e.createMap=new n.Map("current-map",{zoom:12,scrollWheel:!0}),t.infoWindow=new n.InfoWindow({offset:new n.Pixel(0,-30)}),n.plugin(["AMap.Driving","AMap.MouseTool"],function(){var t=new n.Driving({map:e.createMap});t.search([{keyword:e.origin},{keyword:e.destination}]),e.drawPolygon=new n.Polygon({strokeColor:"#449dff",fillOpacity:0,path:e.polygon}),e.createMap.add(e.drawPolygon)})}).catch(function(){return console.log("地图加载失败")})},livePosition:function(){var t=this,e=this,n=null;if("WebSocket"in window){var i="ws://120.77.252.208:8080/gps/WebSocket/"+this.taskId;n=new WebSocket(i)}else alert("Not support websoket");n.onerror=function(){console.log("websocket_err")},n.onopen=function(){console.log("websocket_open")},n.onmessage=function(n){var i=JSON.parse(n.data),r=i.data,o=r.equip;console.log(r);var a=r.outboundRoadlog.longitude,s=r.outboundRoadlog.latitude,c=new AMap.LngLat(a,s);if(t.prisonerList[r.equip])t.markerList.forEach(function(e,n){var i=e.getExtData().id;if(i==o){t.prisonerList[o].path.push(c);var l=AMap.GeometryUtil.isPointInRing(c,t.polygon),p="",u="",d="",f="",g=r.stauts,h=r.prisoner,b=r.police,m=r.time;l?(p="green",u="正常"):(p="red",u="越界"),d="正常"==g?"green":"red",AMap.plugin("AMap.Geocoder",function(){var t=new AMap.Geocoder({radius:1e3});t.getAddress([a,s],function(t,n){"complete"===t&&"OK"===n.info?(f=n.regeocode.formattedAddress,e.content='\n                      <div style="width:200px;">\n                        <ul class="label-list">\n                          <li>脚扣：'.concat(o,"</li>\n                          <li>干警：").concat(b,"</li>\n                          <li>犯人：").concat(h,"</li>\n                          <li>地址：").concat(f,"</li>\n                          <li>时间：").concat(m,'</li>\n                          <li>状态：<span style="font-size:16px;padding:3px;background-color:').concat(p,';color:#fff;border-radius:5px;height:18px;line-height:18px;display: inline-block;text-align:center;">').concat(u,'</span></li>\n                          <li>设备：<span style="font-size:16px;padding:3px;background-color:').concat(d,';color:#fff;border-radius:5px;height:18px;line-height:18px;display: inline-block;text-align:center;">').concat(g,"</span></li>\n                        </ul>\n                      </div>")):console.log("根据经纬度查询地址失败")})});var v=t.prisonerList[o].path;t.prisonerList[o].polyline.setPath(v);var y=AMap.GeometryUtil.distance(v[v.length-2],v[v.length-1]);e.moveAlong(v.slice(v.length-2),3.6*y)}});else{t.$set(t.prisonerList,[o],{}),t.prisonerList[o].path=[c],t.prisonerList[o].polyline=new AMap.Polyline({map:t.createMap,strokeWeight:5,strokeStyle:"solid",strokeColor:"#"+Math.floor(200*Math.random()).toString(10),lineJoin:"round",lineCap:"round",strokeOpacity:0}),t.prisonerList[o].passedPolyline=new AMap.Polyline({map:t.createMap,strokeColor:"#"+Math.floor(200*Math.random()).toString(10),strokeWeight:5,strokeStyle:"solid",lineJoin:"round",lineCap:"round"});var l=new AMap.Marker({map:e.createMap,position:c,extData:{id:o}});l.setLabel({offset:new AMap.Pixel(20,10),content:"<div>".concat(r.prisoner,"</div>"),direction:"right"}),l.on("click",function(e){t.infoWindow.setContent(e.target.content),t.infoWindow.open(t.createMap,e.target.getPosition())}),l.on("moving",function(e){t.prisonerList[o].passedPolyline.setPath(t.prisonerList[o].path.slice(t.prisonerList[o].path.length-10))}),t.markerList.push(l)}}}}},u=p,d=(n("bef0"),n("2877")),f=Object(d["a"])(u,i,r,!1,null,null,null);e["default"]=f.exports},bef0:function(t,e,n){"use strict";var i=n("a29b"),r=n.n(i);r.a},c385:function(t,e,n){"use strict"},fa0a:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task-center-wrap"},[n("div",{staticClass:"title-list-wrap"},[n("ul",{staticClass:"title-list"},[n("li",[n("router-link",{attrs:{to:"/manage/taskcenter/tasklist"}},[t._v("任务列表")])],1),n("li",[n("router-link",{attrs:{to:"/manage/taskcenter/currentmap"}},[t._v("当前位置")])],1),n("li",[n("router-link",{attrs:{to:"/manage/taskcenter/historypath"}},[t._v("历史轨迹")])],1),n("li",[n("router-link",{attrs:{to:"/manage/taskcenter/subdue"}},[t._v("制伏")])],1)])]),n("div",{staticClass:"task-center-main"},[n("router-view")],1)])},r=[],o=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("bd86")),a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-page"},[n("p",{staticClass:"error-msg"},[t._v("请先在任务列表中选择要查看的任务")])])}],c={name:"errorPage"},l=c,p=(n("7874"),n("2877")),u=Object(p["a"])(l,a,s,!1,null,null,null),d=u.exports,f=n("aacb"),g=n("2f62");function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var m={name:"TaskCenter",components:{ErrorPage:d,CurrentMap:f["default"]},data:function(){return{activeName:"taskList"}},methods:b({},Object(g["c"])(["updateMultipleSelection"]),{handleClick:function(t,e){"subdue"===t.name?this.$messageBox({message:'<div style="height:300px;color:#24A413;display:flex;justify-content:center;align-items:center;flex-direction:column;">\n                      <div class="el-icon-success" style="font-size:80px"></div>\n                      <div style="font-size:30px;margin-top:20px">制伏成功！</div>\n                    </div>',dangerouslyUseHTMLString:!0}):"currPos"===t.name?this.$router.push("/manage/taskcenter/currentmap"):"taskList"===t.name&&this.$router.push("/manage/taskcenter/tasklist")}}),beforeDestroy:function(){this.updateMultipleSelection([])}},v=m,y=(n("0a72"),Object(p["a"])(v,i,r,!1,null,null,null));e["default"]=y.exports}}]);